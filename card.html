<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="page-title">名片</title>
<link rel="stylesheet" href="style.css">
<style>
/* ===== 卡片容器與翻轉動畫 ===== */
body {
  font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
  background: #131313;
  margin: 0;
  padding: 0;
  color: #fff;
}

.card-container {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
}

.card {
  width: 380px;
  height: 540px;
  border-radius: 16px;
  background: #191919;
  box-shadow: 0 6px 36px rgba(0,0,0,0.4);
  position: relative;
  transition: transform 0.6s;
  transform-style: preserve-3d;
  cursor: pointer;
}

.card.flipped {
  transform: rotateY(180deg);
}

.card .front, .card .back {
  position: absolute;
  width: 100%;
  height: 100%;
  padding-bottom: 36px;
  background: #191919;
  color: #fff;
  border-radius: 16px;
  box-sizing: border-box;
  backface-visibility: hidden;
  display: flex;
  flex-direction: column;
}

.card .back {
  transform: rotateY(180deg);
}

/* ===== 卡片內容樣式 ===== */
.card-logo {
  margin: 38px auto 0 auto;
  width: 180px;
  font-size: 2.2rem;
  font-weight: 800;
  letter-spacing: 2px;
  text-align: center;
}
.card-logo .f-col {
  color: #84e062; /* F 字母色 */
}
.card-logo .o-dot {
  color: #11f39a; /* O 裝飾色 */
}

.card-title {
  font-size: 1.21rem;
  font-weight: bold;
  margin: 24px 0 9px 34px;
}

.card-info-list {
  margin: 0 0 0 34px;
  font-size: 1rem;
  line-height: 1.7;
}
.card-info-item {
  display: flex;
  gap: 0.8em;
  margin-bottom: 0.13em;
}
.card-info-item .label {
  color: #a0a0a0;
  min-width: 74px;
}
.card-info-item .value {
  color: #fff;
  font-weight: 500;
}

.card-brief {
  margin: 20px 30px 0 34px;
  font-size: 1rem;
  color: #dcdcdc;
}

.card-skills {
  margin: 22px 30px 0 34px;
  color: #f4ef77;
  font-size: 1rem;
  font-weight: 700;
}

.card-bottom-tip {
  position: absolute;
  left: 50%;
  bottom: 24px;
  transform: translateX(-50%);
  color: #a0a0a0;
  font-size: 1.05rem;
  letter-spacing: 1px;
  font-weight: 500;
  opacity: 0.87;
}

.actions {
  text-align: center;
  margin-top: 20px;
}
.actions button {
  background: #11f39a;
  border: none;
  padding: 10px 14px;
  margin: 4px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
}
.actions button:hover {
  background: #0ed08d;
}
</style>
</head>
<body>
  <div class="card-container">
    <div class="card" id="business-card">
      <!-- 正面 -->
      <div class="front" id="card-front">
        <div class="card-logo">
          <span class="f-col">F</span>ORWARD
        </div>
        <div class="card-title">My Contact Info.</div>
        <div class="card-info-list">
          <div class="card-info-item"><span class="label">name</span><span class="value" id="front-name">載入中...</span></div>
          <div class="card-info-item"><span class="label">brief</span><span class="value" id="front-brief"></span></div>
          <div class="card-info-item"><span class="label">phone</span><span class="value" id="front-phone"></span></div>
          <div class="card-info-item"><span class="label">email</span><span class="value" id="front-email"></span></div>
          <div class="card-info-item"><span class="label">skills</span><span class="value" id="front-skills"></span></div>
        </div>
        <div class="card-bottom-tip">TURN TO FLIP</div>
      </div>
      <!-- 背面 -->
      <div class="back" id="card-back">
        <div class="card-logo">
          <span class="f-col">F</span>ORWARD
        </div>
        <div class="card-title">Emergency Contact</div>
        <div class="card-info-list">
          <div class="card-info-item"><span class="label">name</span><span class="value" id="back-name"></span></div>
          <div class="card-info-item"><span class="label">phone</span><span class="value" id="back-phone"></span></div>
          <div class="card-info-item"><span class="label">email</span><span class="value" id="back-email"></span></div>
        </div>
        <div class="card-bottom-tip">TURN TO FLIP</div>
      </div>
    </div>
  </div>
  <div class="actions">
    <button id="share-btn">分享名片</button>
    <button id="copy-btn">複製聯絡資訊</button>
  </div>

<script>
const SHEET_ID = '1LMTaAiF-V-k7M4I-nFFVHBdGhrgvBcMldg39uhn70WM';
const SHEET_NAME = '表單回應 1';
const API_KEY = '你的APIKEY'; // TODO: 放你的 API KEY
const API_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(SHEET_NAME)}?alt=json&key=${API_KEY}`;

function maskEmail(email) {
  if (!email) return '';
  const [name, domain] = email.split('@');
  return name[0] + "***@" + domain;
}

async function fetchSheetData() {
  const res = await fetch(API_URL);
  const data = await res.json();
  const rows = data.values;
  return rows.slice(1).map(row => ({
    frontName: row[1],
    frontPhone: row[2],
    frontEmail: row[3],
    backName: row[4],
    backPhone: row[5],
    backEmail: row[6],
    skills: row[7],
    brief: row[8]
  }));
}

async function loadCardData() {
  const params = new URLSearchParams(window.location.search);
  const userKey = params.get('user');
  const data = await fetchSheetData();
  const cardData = data.find(c => c.frontEmail.split('@')[0] === userKey);
  if (!cardData) {
    document.body.innerHTML = '<p style="color:white;text-align:center;margin-top:50px;">找不到該名片</p>';
    return;
  }
  document.getElementById('page-title').textContent = `${cardData.frontName} - 名片`;

  document.getElementById('front-name').textContent = cardData.frontName;
  document.getElementById('front-phone').textContent = cardData.frontPhone;
  document.getElementById('front-email').textContent = maskEmail(cardData.frontEmail);
  document.getElementById('front-skills').textContent = cardData.skills;
  document.getElementById('front-brief').textContent = cardData.brief;

  document.getElementById('back-name').textContent = cardData.backName;
  document.getElementById('back-phone').textContent = cardData.backPhone;
  document.getElementById('back-email').textContent = maskEmail(cardData.backEmail);

  document.getElementById('business-card').addEventListener('click', e => {
    e.currentTarget.classList.toggle('flipped');
  });

  document.getElementById('share-btn').addEventListener('click', () => {
    if (navigator.share) {
      navigator.share({
        title: `${cardData.frontName}的名片`,
        url: window.location.href
      });
    } else {
      alert('此瀏覽器不支援分享功能');
    }
  });

  document.getElementById('copy-btn').addEventListener('click', () => {
    navigator.clipboard.writeText(`${cardData.frontName}\n${cardData.frontPhone}\n${cardData.frontEmail}`);
    alert('聯絡資訊已複製');
  });
}

loadCardData();
</script>
</body>
</html>
